module.exports=function(n){var r={};function o(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}return o.m=n,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=10)}([function(t,e){t.exports=require("xlsx")},,,,,,,function(t,e){t.exports=require("babel-runtime/core-js/object/keys")},function(t,e){t.exports=require("babel-runtime/helpers/toConsumableArray")},,function(t,e,n){"use strict";n.r(e);var r=new window.SpeechSynthesisUtterance;function o(){window.speechSynthesis.cancel()}var i={speak:function(t){o(),r.text=t,window.speechSynthesis.speak(r)},stop:o,onend:function(t){r.onend=t}};window.URL=window.URL||window.webkitURL,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var s=new(window.webkitAudioContext||window.AudioContext),a=function(t,e){(e=e||{}).sampleBits=e.sampleBits||16,e.sampleRate=e.sampleRate||16e3;var n=s.createMediaStreamSource(t),r=(s.createScriptProcessor||s.createJavaScriptNode).apply(s,[4096,1,1]),a={size:0,buffer:[],inputSampleRate:s.sampleRate,inputSampleBits:16,outputSampleRate:e.sampleRate,oututSampleBits:e.sampleBits,input:function(t){this.buffer.push(new Float32Array(t)),this.size+=t.length},compress:function(){for(var t=new Float32Array(this.size),e=0,n=0;n<this.buffer.length;n++)t.set(this.buffer[n],e),e+=this.buffer[n].length;for(var r=parseInt(this.inputSampleRate/this.outputSampleRate),o=t.length/r,i=new Float32Array(o),a=0,s=0;a<o;)i[a]=t[s],s+=r,a++;return i},encodeWAV:function(){var t=Math.min(this.inputSampleRate,this.outputSampleRate),e=Math.min(this.inputSampleBits,this.oututSampleBits),n=this.compress(),r=n.length*(e/8),o=new ArrayBuffer(44+r),i=new DataView(o),a=0,s=function(t){for(var e=0;e<t.length;e++)i.setUint8(a+e,t.charCodeAt(e))};if(s("RIFF"),a+=4,i.setUint32(a,36+r,!0),a+=4,s("WAVE"),a+=4,s("fmt "),a+=4,i.setUint32(a,16,!0),a+=4,i.setUint16(a,1,!0),a+=2,i.setUint16(a,1,!0),a+=2,i.setUint32(a,t,!0),a+=4,i.setUint32(a,1*t*(e/8),!0),a+=4,i.setUint16(a,e/8*1,!0),a+=2,i.setUint16(a,e,!0),a+=2,s("data"),a+=4,i.setUint32(a,r,!0),a+=4,8===e)for(var u=0;u<n.length;u++,a++){var c=Math.max(-1,Math.min(1,n[u])),f=c<0?32768*c:32767*c;f=parseInt(255/(65535/(f+32768))),i.setInt8(a,f,!0)}else for(var l=0;l<n.length;l++,a+=2){var p=Math.max(-1,Math.min(1,n[l]));i.setInt16(a,p<0?32768*p:32767*p,!0)}return new Blob([i],{type:"audio/wav"})}};this.start=function(){this.stop(),n.connect(r),r.connect(s.destination)},this.stop=function(){n.disconnect(),r.disconnect()},this.getBlob=function(){return this.stop(),a.encodeWAV()},this.play=function(t){t.src=window.URL.createObjectURL(this.getBlob())},this.upload=function(t){t(this.getBlob())},this.onProgress=function(i){r.onaudioprocess=function(t){for(var e=t.inputBuffer.getChannelData(0),n=Math.floor(e.length/10),r=0,o=0;o<n;o++)r+=Math.abs(e[10*o]);a.input(t.inputBuffer.getChannelData(0)),i(r)}}};a.throwError=function(t){i.speak(t)},a.canRecording=null!=navigator.getUserMedia,a.get=function(n,r){n&&(navigator.getUserMedia?navigator.getUserMedia({audio:!0},function(t){var e=new a(t,r);n(e)},function(t){switch(t.code||t.name){case"PERMISSION_DENIED":case"PermissionDeniedError":a.throwError("用户拒绝提供信息。");break;case"NOT_SUPPORTED_ERROR":case"NotSupportedError":a.throwError("浏览器不支持硬件设备。");break;case"MANDATORY_UNSATISFIED_ERROR":case"MandatoryUnsatisfiedError":a.throwError("无法发现指定的硬件设备。");break;default:a.throwError("无法打开麦克风。异常信息:"+(t.code||t.name))}}):a.throwErr("当前浏览器不支持录音功能。"))};var u=a,c="";function f(){c&&c.stop()}var l={start:function(i){c&&c.stop(),u.get(function(t){(c=t).start();var e=void 0,n=void 0,r=void 0,o=setTimeout(function(){r(!n)},3e3);c.onProgress(function(t){if(r=function(t){o&&clearTimeout(o),e&&clearTimeout(e),n=!1,f(),i&&i(t?"error":"end")},i(t),!n&&20<t&&i&&(n=!0,i("start")),n)if(t<20){if(e)return;e=setTimeout(function(){r()},2e3)}else e&&(clearTimeout(e),e="")})})},stop:f,play:function(t){c&&c.play(t)},getBlob:function(){return c?c.getBlob():null},upload:function(t){c&&c.upload(t)}},p=n(7),d=n.n(p),h=n(8),m=n.n(h),v=n(0),w=n.n(v),b=function(t){var e=t.name,n=void 0===e?"excel":e,r=t.data,o=void 0===r?[]:r,i=t.header,a=void 0===i?{}:i,s=t.skipHeader,u=void 0===s||s,c=[].concat(m()(o));c.unshift(a);var f=w.a.utils.json_to_sheet(c,{header:d()(a),skipHeader:u}),l=w.a.utils.book_new();w.a.utils.book_append_sheet(l,f,"SheetJS"),w.a.writeFile(l,n+".xlsx")};n.d(e,"recorder",function(){return l}),n.d(e,"jsonToExcel",function(){return b}),n.d(e,"speaker",function(){return i})}]);